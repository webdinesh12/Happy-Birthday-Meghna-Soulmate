<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Happy Birthday â€” Meghu ğŸ’– (2025)</title>

    <!-- Fonts & libs -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Great+Vibes&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="tsparticles"></div>

    <!-- LOADER + MUSIC -->
    <div id="loader">
        <h2>Just a sec â€” surprise for Meghu ğŸ’</h2>
        <p>Playing a sweet tune... Tap the music icon to mute/unmute.</p>
    </div>

    <div class="topbar">
        <div class="left-controls">
            <button id="diaryBtn" class="btn">Open Diary</button>
            <!-- <button id="addEntry" class="btn mini">Add entry</button> -->
        </div>
        <div>
            <button id="musicBtn" class="btn">ğŸµ</button>
            <!-- <button id="helpBtn" class="btn">?</button> -->
        </div>
    </div>

    <main class="app" role="main">
        <section class="left">
            <h1 class="title">Happy Birthday, Meghu ğŸ’–</h1>
            <div class="text-wrapper">
                <div class="sub">To the one who lights my life</div>
                <p class="desc">I made this page for you â€” press the buttons, play, and enjoy. Everything is on this
                    page: a
                    tiny heart, playful questions, confetti, and our diary. You can add or duplicate diary entries with
                    images and captions.</p>
                <p class="desc">This is for my cute sweet mamma who always take care of me I know I was late becouse of
                    some reason so sorry for that but I am not forgot your special day my special day is always when I
                    am with you you are my greatest achivement. Happy birthday my sweet heaert, my soulmate, my partner
                    and my Lakhsmi, I love you.</p>

                <div class="actions">
                    <button id="askLove" class="btn btn-primary">Open your surprise</button>
                    <button id="revealNote" class="btn">Read a secret note</button>
                </div>
            </div>

            <div class="hint" style="margin-top: 20px;">Tip: If the "No" button tries to escape â€” chase it ğŸ˜„</div>
        </section>

        <aside class="right">
            <div class="heart-wrap">
                <div id="heart" class="heart" title="You're my heart">
                    <div
                        style="position:absolute;left:50%;top:45%;transform:translate(-50%,-50%);width:120px;height:120px;border-radius:50px;opacity:.12;background:linear-gradient(90deg,#fff,transparent)">
                    </div>
                </div>
            </div>
            <div class="hint">Tap "Open your surprise" for the big question.</div>
        </aside>
    </main>

    <!-- Diary full-screen SPA panel -->
    <section id="diaryPanel" class="diary-panel" aria-hidden="true">
        <div class="diary-header">
            <div style="display:flex;align-items:center;gap:12px">
                <div style="font-family:'Great Vibes',cursive;font-size:28px;color:var(--accent)">Our Diary â€” Meghu & Me
                </div>
                <div style="color:rgba(230,238,246,0.7)">Flip through our moments</div>
            </div>
            <div>
                <button id="closeDiary" class="btn mini">Close</button>
            </div>
        </div>

        <div class="diary-body">
            <div class="diary">
                <article class="entry" data-id="entry-1">
                    <img class="photo" src="images/img (1).jpg" alt="her smile">
                    <div class="cap">The day I first saw your smile â€” I melted ğŸŒ¸</div>
                </article>

                <article class="entry" data-id="entry-2">
                    <img class="photo" src="images/img (2).jpg" alt="our moment">
                    <div class="cap">Little silly adventures together âœ¨</div>
                </article>

                <article class="entry" data-id="entry-3">
                    <img class="photo" src="images/img (3).jpg" alt="our laughter">
                    <div class="cap">When your laughter became my favorite sound â¤ï¸</div>
                </article>

                <article class="entry" data-id="entry-4">
                    <img class="photo" src="images/img (4).jpg" alt="sweet chaos">
                    <div class="cap">A little chaos, a lot of love â€” thatâ€™s us ğŸ’«</div>
                </article>

                <article class="entry" data-id="entry-5">
                    <img class="photo" src="images/img (5).jpg" alt="crazy faces">
                    <div class="cap">Those crazy faces we make â€” pure happiness ğŸ˜‚</div>
                </article>

                <article class="entry" data-id="entry-6">
                    <img class="photo" src="images/img (6).jpg" alt="our walk">
                    <div class="cap">That walk where time just stopped for us ğŸš¶â€â™€ï¸ğŸ’</div>
                </article>

                <article class="entry" data-id="entry-7">
                    <img class="photo" src="images/img (7).jpg" alt="her eyes">
                    <div class="cap">Your eyes â€” my calm place ğŸŒ·</div>
                </article>

                <article class="entry" data-id="entry-8">
                    <img class="photo" src="images/img (8).jpg" alt="funny memory">
                    <div class="cap">We laughed till our cheeks hurt ğŸ˜‚ğŸ’–</div>
                </article>

                <article class="entry" data-id="entry-9">
                    <img class="photo" src="images/img (9).jpg" alt="cute pout">
                    <div class="cap">That little poutâ€¦ impossible to ignore ğŸ˜š</div>
                </article>

                <article class="entry" data-id="entry-10">
                    <img class="photo" src="images/img (10).jpg" alt="evening vibe">
                    <div class="cap">Evenings feel special when itâ€™s with you ğŸŒ†</div>
                </article>

                <article class="entry" data-id="entry-11">
                    <img class="photo" src="images/img (11).jpg" alt="rain moment">
                    <div class="cap">Dancing in the rain â€” our favorite kind of madness â˜”ğŸ’ƒ</div>
                </article>

                <article class="entry" data-id="entry-12">
                    <img class="photo" src="images/img (12).jpg" alt="coffee date">
                    <div class="cap">Coffee + You = Perfect day â˜•â¤ï¸</div>
                </article>

                <article class="entry" data-id="entry-13">
                    <img class="photo" src="images/img (13).jpg" alt="sweet hug">
                    <div class="cap">That one hug that said everything ğŸ¤—ğŸ’</div>
                </article>

                <article class="entry" data-id="entry-14">
                    <img class="photo" src="images/img (14).jpg" alt="travel memory">
                    <div class="cap">Every trip with you feels like home ğŸ§³ğŸ’«</div>
                </article>

                <article class="entry" data-id="entry-15">
                    <img class="photo" src="images/img (15).jpg" alt="funny selfie">
                    <div class="cap">Our selfies could win awards for cuteness ğŸ¥°ğŸ“¸</div>
                </article>

                <article class="entry" data-id="entry-16">
                    <img class="photo" src="images/img (16).jpg" alt="birthday smile">
                    <div class="cap">That birthday smile â€” I can never forget ğŸ‚ğŸ’–</div>
                </article>

                <article class="entry" data-id="entry-17">
                    <img class="photo" src="images/img (17).jpg" alt="sunset moment">
                    <div class="cap">We watched sunsets and dreamt of tomorrows ğŸŒ…</div>
                </article>

                <article class="entry" data-id="entry-18">
                    <img class="photo" src="images/img (18).jpg" alt="crazy dance">
                    <div class="cap">Our dance moves? Questionable. Our vibe? Unmatched ğŸ’ƒğŸ•º</div>
                </article>

                <article class="entry" data-id="entry-19">
                    <img class="photo" src="images/img (19).jpg" alt="peaceful moment">
                    <div class="cap">That peaceful silence where words werenâ€™t needed ğŸŒ™</div>
                </article>

                <article class="entry" data-id="entry-20">
                    <img class="photo" src="images/img (20).jpg" alt="special night">
                    <div class="cap">Every night with you feels like a dream âœ¨</div>
                </article>

                <article class="entry" data-id="entry-21">
                    <img class="photo" src="images/img (21).jpg" alt="forever us">
                    <div class="cap">From laughter to love â€” every page is us ğŸ’Œ</div>
                </article>
            </div>
        </div>
    </section>

    <!-- background music (replace 'your-music.mp3' with your file) -->
    <audio id="bgAudio" loop preload="auto">
        <source src="music/apoclyps.m4a" type="audio/mpeg">
    </audio>

    <script>
        /* ------------------- Particles ------------------- */
        tsParticles.load('tsparticles', {
            fullScreen: { enable: false },
            fpsLimit: 60,
            particles: {
                number: { value: 60 },
                color: { value: ['#ff6aa1', '#7ef1f5', '#ffd27e'] },
                shape: { type: 'circle' },
                opacity: { value: 0.7, random: { enable: true, minimumValue: 0.2 } },
                size: { value: { min: 1, max: 6 } },
                move: { enable: true, speed: 0.9, outModes: { default: 'out' } },
                links: { enable: true, distance: 120, color: '#5effff', opacity: 0.06, width: 1 }
            },
            interactivity: { detectsOn: 'canvas', events: { onHover: { enable: true, mode: 'repulse' }, onClick: { enable: true, mode: 'push' } }, modes: { push: { quantity: 4 }, repulse: { distance: 80 } } },
            detectRetina: true,
            background: { color: 'transparent' }
        });

        /* ------------------- Loader & initial music start ------------------- */
        const loader = document.getElementById('loader');
        const bgAudio = document.getElementById('bgAudio');
        const musicBtn = document.getElementById('musicBtn');
        let isPlaying = false;

        window.addEventListener('load', () => {
            setTimeout(() => {
                loader.style.transition = 'opacity 0.9s'; loader.style.opacity = '0'; setTimeout(() => loader.remove(), 900);
                gsap.to('.app', { opacity: 1, duration: 1.2 });
                try {
                    bgAudio.play()
                        .then(() => {
                            isPlaying = true;
                            musicBtn.textContent = 'ğŸ”‡'; // show mute icon when playing
                        })
                        .catch(() => {
                            // Autoplay blocked
                            showMusicPrompt();
                        });
                } catch (e) {
                    showMusicPrompt();
                }
                // small celebratory confetti
                setTimeout(() => { confetti({ particleCount: 100, spread: 140, origin: { y: 0.6 } }); }, 1200);
            }, 1100);
        });

        /* Toggle music manually when button clicked */
        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                bgAudio.pause();
                isPlaying = false;
                musicBtn.textContent = 'ğŸµ'; // show play icon
                Swal.fire('Music paused ğŸ§', 'Tap again to play sweet tunes â¤ï¸', 'info');
            } else {
                bgAudio.play().then(() => {
                    isPlaying = true;
                    musicBtn.textContent = 'ğŸ”‡';
                    Swal.fire('Now playing ğŸ’', 'Romantic vibes are on!', 'success');
                });
            }
        });

        /* SweetAlert prompt when autoplay blocked */
        async function showMusicPrompt() {
            const result = await Swal.fire({
                title: 'ğŸ¶ A little request...',
                html: `
                <p style="font-size:16px;line-height:1.6">
                    Would you like to listen to a soft romantic tune while exploring? ğŸ’•
                </p>
                `,
                showCancelButton: true,
                confirmButtonText: 'Yes, play it ğŸ’–',
                cancelButtonText: 'No, keep it silent ğŸ˜Œ',
                allowOutsideClick: false
            });

            if (result.isConfirmed) {
                bgAudio.play().then(() => {
                    isPlaying = true;
                    musicBtn.textContent = 'ğŸ”‡';
                    // Swal.fire('Yay! ğŸ§', 'Music started â€” enjoy the vibe!', 'success');
                });
            } else {
                musicBtn.textContent = 'ğŸµ'; // allow manual start later
                Swal.fire('No worries ğŸ˜Š', 'You can start it anytime by tapping ğŸµ', 'info');
            }
        }

        // musicBtn.addEventListener('click', () => {
        //     if (!isPlaying) { bgAudio.play(); isPlaying = true; musicBtn.textContent = 'ğŸ”‡'; }
        //     else { bgAudio.pause(); isPlaying = false; musicBtn.textContent = 'ğŸµ'; }
        // });

        /* ------------------- Heart pulse ------------------- */
        const heart = document.getElementById('heart');
        gsap.fromTo(heart, { scale: 0.96 }, { scale: 1.06, duration: 1.1, ease: 'sine.inOut', yoyo: true, repeat: -1 });

        /* ------------------- Main interactions (SweetAlert) ------------------- */
        const askBtn = document.getElementById('askLove');
        let noCount = 0; // how many times she said "No"

        askBtn.addEventListener('click', async () => {
            await askLoveQuestion();
        });

        async function askLoveQuestion() {
            const result = await Swal.fire({
                title: 'Quick question...ğŸ’“',
                text: 'Do you love me?',
                showCancelButton: true,
                confirmButtonText: 'Yes, obviously!',
                cancelButtonText: 'No...',
                allowOutsideClick: false,
                allowEscapeKey: false
            });

            if (result.isConfirmed) {
                celebrate();
                await Swal.fire({
                    title: 'YAY! ğŸ˜',
                    html: 'I love you forever â†’ <b>Happy Birthday, Meghu!</b>',
                    confirmButtonText: 'Aww ğŸ’–'
                });
            } else if (result.dismiss === Swal.DismissReason.cancel) {
                await playfulNo();
            }
        }

        async function playfulNo() {
            await Swal.fire({
                title: 'Are you sure? ğŸ¥º',
                html: `
            <div style="display:flex;gap:12px;justify-content:center;margin-top:14px;position:relative;height:50px;">
                <button id="yesBtn" class="swal2-confirm swal2-styled" style="margin:0;position:absolute;">Yes</button>
                <button id="noBtn" class="swal2-cancel swal2-styled" style="margin:0;position:absolute;left:120px;">No</button>
            </div>
        `,
                showConfirmButton: false,
                allowOutsideClick: false,
                didOpen: () => {
                    const popup = Swal.getPopup();
                    const yes = popup.querySelector('#yesBtn');
                    const no = popup.querySelector('#noBtn');

                    yes.style.transition = 'all 0.25s ease';
                    let moves = 0;

                    // â€œYESâ€ runs away randomly when hovered
                    yes.addEventListener('mouseenter', moveYesButton);
                    yes.addEventListener('click', moveYesButton);

                    function moveYesButton() {
                        noCount++;

                        if (noCount >= 5) {
                            Swal.close();
                            finalSweetMessage();
                            return;
                        }

                        const popupRect = popup.getBoundingClientRect();
                        const maxX = popupRect.width - yes.offsetWidth - 40;
                        const maxY = popupRect.height - yes.offsetHeight - 40;

                        // Generate random positions (avoid same small jumps)
                        const randomX = (Math.random() * maxX - maxX / 2) * 0.8;
                        const randomY = (Math.random() * maxY - maxY / 2) * 0.8;

                        // Animate with a playful transition
                        yes.style.transition = 'transform 0.25s ease';
                        yes.style.transform = `translate(${randomX}px, ${randomY}px)`;

                        if (noCount === 3) yes.textContent = 'Canâ€™t catch me ğŸ˜œ';
                        if (noCount === 4) yes.textContent = 'Hehe almost! ğŸ’';
                    }
                    
                    // â€œNoâ€ behaves normally â€” brings you back to main question
                    no.addEventListener('click', () => {
                        noCount++;
                        if (noCount >= 24) {
                            Swal.close();
                            finalSweetMessage();
                            return;
                        }
                        Swal.close();
                        askLoveQuestion();
                    });
                }
            });
        }

        async function finalSweetMessage() {
            await Swal.fire({
                title: 'ğŸ˜Œ I knew it...',
                html: `
            <p style="font-size:16px;line-height:1.6">
                You don't love me? ğŸ˜¢<br><br>
                It's okay... because I love you enough for both of us ğŸ’•<br>
                Iâ€™ll love you forever and ever and ever â€” no matter what.<br><br>
                You know what? You <b>do</b> love me, you just donâ€™t know it yet ğŸ˜‰ğŸ’–
            </p>
        `,
                confirmButtonText: 'Aww ğŸ¥°'
            });
        }

        /* Confetti celebration */
        function celebrate() {
            confetti({
                particleCount: 200,
                spread: 100,
                origin: { y: 0.6 }
            });
        }

        function celebrate() {
            confetti({ particleCount: 140, spread: 160, origin: { y: 0.6 } });
            gsap.fromTo(heart, { scale: 1 }, { scale: 1.18, duration: 0.35, yoyo: true, repeat: 3, ease: 'elastic.out(1,0.6)' });
            playMelody();
            // temporary particle energy
            const item = tsParticles.domItem(0); if (item) { item.options.particles.move.speed = 2.2; item.refresh(); setTimeout(() => { item.options.particles.move.speed = 0.9; item.refresh(); }, 4000); }
        }

        /* small melody for celebration */
        function playMelody() { try { const ac = new (window.AudioContext || window.webkitAudioContext)(); const now = ac.currentTime; const notes = [440, 660, 880, 660, 440]; notes.forEach((n, i) => { const o = ac.createOscillator(); const g = ac.createGain(); o.type = 'sine'; o.frequency.value = n; g.gain.setValueAtTime(0.0001, now + i * 0.22); g.gain.exponentialRampToValueAtTime(0.12, now + i * 0.22 + 0.02); g.gain.exponentialRampToValueAtTime(0.0001, now + i * 0.22 + 0.18); o.connect(g); g.connect(ac.destination); o.start(now + i * 0.22); o.stop(now + i * 0.22 + 0.22); }); } catch (e) { /* ignore */ } }

        /* ------------------- Secret note ------------------- */
        document.getElementById('revealNote').addEventListener('click', () => {
            Swal.fire({ title: 'A little secret', html: `<div style="text-align:left;line-height:1.5"> <p>My dearest Meghu,</p> <p>Every day with you feels like a new song â€” warm, silly and full of sparkles. I love how you laugh, how you think, and that your hand fits perfectly in mine.</p> <p><b>Happy Birthday!</b> Here's to more late-night talks, tiny adventures, and all the dreams we'll chase together.</p> <p style="margin-top:8px">â€” <i>Forever yours</i></p> </div>`, confirmButtonText: 'Kiss ğŸ˜˜' });
        });

        /* ------------------- Diary SPA behavior ------------------- */
        const diaryBtn = document.getElementById('diaryBtn');
        const diaryPanel = document.getElementById('diaryPanel');
        const closeDiary = document.getElementById('closeDiary');
        diaryBtn.addEventListener('click', () => { diaryPanel.classList.add('open'); diaryPanel.setAttribute('aria-hidden', 'false'); });
        closeDiary.addEventListener('click', () => { diaryPanel.classList.remove('open'); diaryPanel.setAttribute('aria-hidden', 'true'); });

        // Add entry button (top-left) â€” it clones the template entry and inserts at top
        const addEntry = document.getElementById('addEntry');
        addEntry.addEventListener('click', () => {
            const diary = document.querySelector('.diary'); const template = diary.querySelector('.entry'); if (!template) return; const clone = template.cloneNode(true); // clear image src + caption for easy editing
            const idx = Date.now(); clone.dataset.id = 'entry-' + idx; clone.querySelector('.photo').src = 'images/replace-me.jpg'; clone.querySelector('.cap').textContent = 'New moment â€” add your caption'; diary.prepend(clone); attachControls(clone); // open diary so she sees it
            diaryPanel.classList.add('open'); diaryPanel.setAttribute('aria-hidden', 'false');
        });

        // Attach event handlers to existing controls
        function attachControls(entry) {
            const cloneBtn = entry.querySelector('.clone'); const remBtn = entry.querySelector('.remove'); const editBtn = entry.querySelector('.edit');
            cloneBtn.addEventListener('click', () => { const copy = entry.cloneNode(true); copy.dataset.id = 'entry-' + Date.now(); attachControls(copy); entry.parentElement.insertBefore(copy, entry.nextSibling); });
            remBtn.addEventListener('click', () => { if (confirm('Remove this entry?')) entry.remove(); });
            editBtn.addEventListener('click', () => { const newCap = prompt('Edit caption:', entry.querySelector('.cap').textContent); if (newCap !== null) entry.querySelector('.cap').textContent = newCap; const newImg = prompt('Change image URL (leave blank to keep):', entry.querySelector('.photo').src); if (newImg) entry.querySelector('.photo').src = newImg; });
        }

        document.querySelectorAll('.entry').forEach(e => attachControls(e));

        /* keyboard accessibility: Esc closes diary */
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { diaryPanel.classList.remove('open'); diaryPanel.setAttribute('aria-hidden', 'true'); } });

        /* tiny help */
        document.getElementById('helpBtn').addEventListener('click', () => {
            Swal.fire({ title: 'How to use', html: `<ul style="text-align:left"><li>Use the <b>Open Diary</b> button to view full-screen diary.</li><li>Click <b>Add entry</b> to add a new slot (replace image src with your image path).</li><li>Use <b>Duplicate</b> to copy an entry, <b>Edit</b> to change caption or image, and <b>Remove</b> to delete.</li><li>Music plays automatically if allowed; use the music button to mute/unmute.</li></ul>` });
        });

        /* ensure audio continues while diary is open (we simply don't pause it) */

        /* small accessibility: focus trap when diary open (simple) */
        diaryPanel.addEventListener('transitionend', () => { if (diaryPanel.classList.contains('open')) diaryPanel.querySelector('.diary').focus(); });

    </script>
</body>

</html>